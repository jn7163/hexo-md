---
title: 正则表达式
date: 2016-10-23 09:17:11
categories:
- 正则表达式
tags:
- 正则表达式
- regexp
keywords: 正则表达式, RegExp
---
> 
正则表达式(Regular Expression)是一种文本模式
包括普通字符(例如，a 到 z 之间的字母)和特殊字符(称为"元字符")
正则表达式使用单个字符串来描述、匹配一系列匹配某个句法规则的字符串。
许多程序设计语言都支持利用正则表达式进行字符串操作

<!-- more -->

## 正则语法
> 
正则表达式是由普通字符(如字符a到z)以及特殊字符(称为**元字符**)组成的文字模式
模式描述在搜索文本时要匹配的一个或多个字符串, 正则表达式作为一个模板，将某个字符模式与所搜索的字符串进行匹配

### 普通字符
> 
普通字符包括没有显式指定为元字符的所有可打印和不可打印字符。这包括所有大写和小写字母、所有数字、所有标点符号和一些其他符号

### 非打印字符
|非打印字符|描述|
|:--------:|----|
|\cx|匹配由`x`指明的**控制字符**.例如`\cM`匹配一个`Control-M`或`回车符`.`x`的值必须为`A-Z`或`a-z`之一.否则,将`c`视为一个原义的`'c'`字符|
|\r|匹配一个**回车符**|
|\n|匹配一个**换行符**|
|\t|匹配一个**制表符**|
|\v|匹配一个**垂直制表符**|
|\f|匹配一个**换页符**|
|\s|匹配任何**空白符**.包括空格,制表符,换页符等.等价于`[ \r\n\f\t\v]`|
|\S|匹配任何**非空白符**.等价于`[^ \r\n\f\t\v]`|

### 特殊字符
> 
许多元字符要求在试图匹配它们时特别对待。若要匹配这些特殊字符，必须首先使字符**转义**，即，将反斜杠字符`\`放在它们前面

|特殊字符|描述|
|:------:|----|
|^|匹配输入字符串的**开始位置**,除非在方括号表达式中使用,此时它表示不接受该字符集合,要匹配`^`字符本身,请使用`\^`|
|$|匹配输入字符串的**结尾位置**,要匹配`$`字符本身,请使用`\$`|
|()|标记一个**子表达式**的开始和结束位置.子表达式可以获取供以后使用.要匹配这些字符,请使用`\(`和`\)`|
|[|标记一个**中括号表达式**的开始.要匹配`[`,请使用`\[`|
|{|标记**限定符表达式**的开始.要匹配`{`,请使用`\{`|
|.|匹配除换行符`\n`*之外*的**任何单字符**.要匹配`.`,请使用`\.`|
|*|匹配前面的子表达式`0次或多次`.要匹配`*`字符,请使用`\*`|
|+|匹配前面的子表达式`1次或多次`.要匹配`+`字符,请使用`\+`|
|?|匹配前面的子表达式`0次或1次`,或指明一个*非贪婪限定符*.要匹配`?`字符,请使用`\?`|
|│|指明两项之间的一个`选择`.要匹配`│`,请使用`\│`|
|\|将下一个字符标记为`或特殊字符、或原义字符、或向后引用、或八进制转义符`.例如`n`匹配字符`n`.`\n`匹配`换行符`.`\\`匹配字符`\`|

### 限定符
> 
限定符用来指定正则表达式的一个给定组件必须要出现多少次才能满足匹配。

|限定符|描述|
|:----:|----|
|*|匹配前面的子表达式`0次或多次`.例如`zo*`能匹配`z`以及`zoo`.等价于`{0,}`|
|+|匹配前面的子表达式`1次或多次`.例如`zo+`能匹配`zo`以及`zoo`,但不能匹配`z`.等价于`{1,}`|
|?|匹配前面的子表达式`0次或1次`.例如`do(es)?`能匹配`do`或`does`中的`do`.等价于`{0,1}`|
|{n}|n是一个非负整数.匹配`确定的n次`.例如`o{2}`不能匹配`Bob`中的`o`,但是能匹配`food`中的两个`o`|
|{n,}|n是一个非负整数.`至少匹配n次`.例如`o{2,}`不能匹配`Bob`中的`o`,但能匹配`foooood`中的所有`o`|
|{n,m}|m和n均为非负整数,其中`n<=m`.`最少匹配n次且最多匹配m次`.例如`o{1,3}`将匹配`fooooood`中的前三个`o`|

`* + ?`限定符都是`贪婪`的,因为它们会尽可能多的匹配文字,只有在它们的后面加上一个`?`就可以实现`非贪婪`或`最小匹配`

如`<p>test</p>`
`<.*>`  匹配结果为`<p>test</p>`
`<.*?>` 匹配结果为`<p>`

### 定位符
> 
定位符使您能够将正则表达式固定到行首或行尾

|定位符|描述|
|:----:|----|
|^|匹配输入字符串的**开始位置**|
|$|匹配输入字符串的**结尾位置**|
|\b|匹配一个`字边界`,即字与空格间的位置|
|\B|匹配`非字边界`|

如:
`\bter`匹配`termina`,但不匹配`abcter`
`abc\b`匹配`qwerabc`,但不匹配`abcqwer`
`\Btty`匹配`xttyx`、`xtty`,但不匹配`ttyx`

### 选择
`|`表示选择
`z|food`    匹配`z`或`food`
`(z|f)ood`  匹配`zood`或`food`.使用圆括号有个副作用:相关的匹配会被暂时缓存.可以在开头加上`?:`来消除此副作用

> 其中`?:`是`非捕获元`之一，还有两个非捕获元是`?=`和`?!`

### 反向引用
> 
对一个正则表达式模式或部分模式两边添加`圆括号`将导致`相关匹配存储到一个临时缓冲区`中，所捕获的每个子匹配都按照在正则表达式模式中从左到右出现的顺序存储。缓冲区编号从`1`开始,最多可存储`99`个捕获的子表达式。每个缓冲区都可以使用`\n`访问，其中`n`为一个标识特定缓冲区的`1-99`的十进制数
**可以使用`非捕获元字符` `?:` `?=` `?!` 来重写捕获，忽略对相关匹配的保存**

反向引用的最简单的、最有用的应用之一，是提供查找文本中两个相同的相邻单词的匹配项的能力。如：
`Is is the cost of of gasoline going up up?`
我们可以用正则来定位此类型语句
`/\b([a-z]+) \1\b/gi    #`g`表示全局匹配,`i`表示忽略大小写`
第一个圆括号匹配一个单词，`\1`表示引用第一个圆括号的匹配内容。即：`word word`

## 元字符
|元字符|描述|
|:----:|----|
|\|将下一个字符标记为`或特殊字符、或原义字符、或向后引用、或八进制转义符`.例如`n`匹配字符`n`.`\n`匹配`换行符`.`\\`匹配字符`\`|
|\cx|匹配由`x`指明的**控制字符**.例如`\cM`匹配一个`Control-M`或`回车符`.`x`的值必须为`A-Z`或`a-z`之一.否则,将`c`视为一个原义的`'c'`字符|
|\r|匹配一个**回车符**|
|\n|匹配一个**换行符**|
|\t|匹配一个**制表符**|
|\v|匹配一个**垂直制表符**|
|\f|匹配一个**换页符**|
|\s|匹配任何**空白符**.包括空格,制表符,换页符等.等价于`[ \r\n\f\t\v]`|
|\S|匹配任何**非空白符**.等价于`[^ \r\n\f\t\v]`|
|^|匹配输入字符串的**开始位置**,除非在方括号表达式中使用,此时它表示不接受该字符集合,要匹配`^`字符本身,请使用`\^`|
|$|匹配输入字符串的**结尾位置**,要匹配`$`字符本身,请使用`\$`|
|\b|匹配一个`字边界`,即字与空格间的位置|
|\B|匹配`非字边界`|
|()|标记一个**子表达式**的开始和结束位置.子表达式可以获取供以后使用.要匹配这些字符,请使用`\(`和`\)`|
|[|标记一个**中括号表达式**的开始.要匹配`[`,请使用`\[`|
|{|标记**限定符表达式**的开始.要匹配`{`,请使用`\{`|
|.|匹配除换行符`\n`*之外*的**任何单字符**.要匹配`.`,请使用`\.`|
|│|指明两项之间的一个`选择`.要匹配`│`,请使用`\│`|
|*|匹配前面的子表达式`0次或多次`.例如`zo*`能匹配`z`以及`zoo`.等价于`{0,}`|
|+|匹配前面的子表达式`1次或多次`.例如`zo+`能匹配`zo`以及`zoo`,但不能匹配`z`.等价于`{1,}`|
|?|匹配前面的子表达式`0次或1次`.或指明一个`非贪婪限定符`.例如`do(es)?`能匹配`do`或`does`中的`do`.等价于`{0,1}`|
|{n}|n是一个非负整数.匹配`确定的n次`.例如`o{2}`不能匹配`Bob`中的`o`,但是能匹配`food`中的两个`o`|
|{n,}|n是一个非负整数.`至少匹配n次`.例如`o{2,}`不能匹配`Bob`中的`o`,但能匹配`foooood`中的所有`o`|
|{n,m}|m和n均为非负整数,其中`n<=m`.`最少匹配n次且最多匹配m次`.例如`o{1,3}`将匹配`fooooood`中的前三个`o`|
|(pattern)|匹配`pattern`并`获取`这一匹配.每个缓冲区都可以使用`\n`访问,其中`n`为一个标识特定缓冲区的`1-99`的十进制数|
|(?:pattern)|匹配`pattern`但`不获取`匹配结果.也就是说这是一个`非获取匹配`,不进行存储供以后使用.这在使用"或"字符`│`来组合一个模式的各个部分很有用|
|(?=pattern)|`正向预查`，在任何**匹配**`pattern`的字符串开始处匹配查找字符串。这是一个`非获取匹配`，也就是说，该匹配不需要获取供以后使用。例如`Windows (?=95│98│NT│2000)`能匹配`Windows 2000`，但不能匹配`Windows 3.1`.预查不消耗字符，也就是说，在一个匹配发生后，在最后一次匹配之后立即开始下一次匹配的搜索，而不是从包含预查的字符之后开始|
|(?!pattern)|`负向预查`，在任何**不匹配**`pattern`的字符串开始处匹配查找字符串。这是一个`非获取匹配`，也就是说，该匹配不需要获取供以后使用。例如`Windows (?!95│98│NT│2000)`能匹配`Windows 3.1`，但不能匹配`Windows 2000`.预查不消耗字符，也就是说，在一个匹配发生后，在最后一次匹配之后立即开始下一次匹配的搜索，而不是从包含预查的字符之后开始|
|x│y|匹配`x`或`y`。例如`z│food`能匹配`z`或`food`.`(z│f)ood`则匹配`zood`或`food`|
|[xyz]|`字符集合`。匹配`所包含的任意单个字符`|
|[^xyz]|`负值字符集合`。匹配`未包含的任意字符`|
|[a-z]|`字符范围`。匹配`指定范围内的任意单个字符`|
|[^a-z]|`负值字符范围`。匹配`任何不在指定范围内的任意字符`|
|\d|匹配`单个数字字符`|
|\D|匹配`非数字字符`|
|\w|匹配`包括下划线的任何单词字符`。等价于`[A-Za-z0-9_]`|
|\W|匹配`任何非单词字符`。等价于`[^A-Za-z0-9_]`|
|\number|匹配`number`，其中`number`是一个正整数。对所获取的匹配的引用|
## 运算优先级

> 正则表达式`从左到右`进行计算，并遵循`优先级`顺序，这与算术表达式非常类似。
`相同优先级的从左到右进行运算`，`不同优先级的运算先高后低`。下表从最高到最低说明了各种正则表达式运算符的优先级顺序

|运算符|描述|
|:----:|----|
|\|转义符|
|()  (?:)  (?=)  (?!)  []|圆括号和方括号|
|*  +  ?  {n}  {n,}  {n,m}|限定符|
|^  $  \任何元字符、任何字符|`定位点`和`序列`(位置和顺序)|
|│|替换,`或`操作|
